{% extends 'base.html' %}

{% block content %}
    <div class="card m-5" style="width: 40rem; height: auto;">
        <div>
            <h2 class="m-4">Add an Event</h2>
            <input type="text" class="form-control mt-3 mb-3 me-4 ms-4 form-group-lg" placeholder="Search for a location" style="width:92%;">
            <div style="overflow: scroll; height: 13rem">
                <table class="table mt-3 mb-3 me-4 ms-4 table-borderless" style="width: 70%">
                    <tbody>
                        <tr>
                            <td><button class="btn btn-secondary" onclick="vars.location = 1">Location 1</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="d-flex">
            <div>
                <input inputmode="decimal" type="number" class="mt-3 mb-3 me-4 ms-4 form-control form-control-lg" id="hours"
                style="width: 5rem;" required placeholder="Hours" aria-label="Hours" min="0" step="0.5">
            </div>
            <div>
                <input type="date" class="mt-3 mb-3 me-4 ms-4 form-control form-control-lg" id="date"
                style="width: 9rem;" required placeholder="Date of event" aria-label="Date of event">
            </div>
            <div>
                <input type="time" class="mt-3 mb-3 me-4 ms-4 form-control form-control-lg" id="time"
                style="width: 6.5rem;" required placeholder="Time of event" aria-label="Time of event">
            </div>
        </div>
        <div>
            <input class="mt-3 mb-3 me-4 ms-4 form-control form-control-lg" id="affiliation-text"
            style="width:92%;" required placeholder="Affiliation Text" aria-label="Affiliation Text">
        </div>
        <div data-mdb-input-init class="form-outline mt-3 mb-3 me-4 ms-4" style="width:92%;">
            <textarea class="form-control form-control-lg" id="textAreaExample1" rows="4" aria-label="Description" required placeholder="Description"></textarea>
        </div>
        <div>
            <button class="btn btn-primary mt-3 mb-4 me-4 ms-4" type="submit" style="float: right;" onclick="add_event()">Submit</button>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script type="text/javascript">
        let vars = {}
        function add_event() {
            let hours = document.getElementById("hours").value
            let date = document.getElementById("date").value
            let time = document.getElementById("time").value
            let affiliation_text = document.getElementById("affiliation-text").value
            let description = document.getElementById("textAreaExample1").value
            fetch("/api/submit-event?hours=" + hours + "&date=" + date +  "&time=" + time + "&affiliation=" + affiliation_text + "&description=" + description + "&location=" + vars.location, {
                credentials: "same-origin",
                method: "POST"
            })
        .then(response => response.json())
        .then(data => {
            if (data.success === true) {
                const redirectUrl = data.redirect_url;
                window.location.href = redirectUrl;
            } else {
                console.log(data.error);
            }
        })
        .catch(error => console.error("Error:", error));
    }
    </script>
{% endblock %}